<template>
    <div style="height: 100%;width: 100%;background-color: #f9f9f9;" >

      <md-toolbar>
        <h3 class="md-title" style="flex: 1">URLHaus Malware Data</h3>
        <md-button  v-bind:href="sourceUrl"  target="_blank">
          Source Website
        </md-button>
        <md-button v-bind:href="rawSourceUrl"  target="_blank">
          Raw Data
        </md-button>
      </md-toolbar>

      <div class="content" style="background-color: #f9f9f9;width: 20%;float: right;height: 50%;">
        <information-view v-bind:malware-data="filteredMalwareData"></information-view>
      </div>

        <div class="content" style="background-color: #f9f9f9;width: 80%">
            <map-view style="" v-bind:malware-data="filteredMalwareData">
            </map-view>
        </div>

      <div class="content"  style="background-color: #f9f9f9;">
        <table-view style="height: 50vh;width: 100%;" v-bind:malware-data="malwareData" @filterUpdated="filterUpdated"></table-view>
      </div>

    </div>
</template>

<script>
import MapView from './MapView'
import TableView from './TableView'
import InformationView from './InformationView'

export default {
  name: 'Home',
  components: {MapView, TableView, InformationView},
  data () {
    return {
      malwareData: null,
      filteredMalwareData: null,
      rawSourceUrl: 'https://urlhaus.abuse.ch/downloads/csv',
      sourceUrl: 'https://urlhaus.abuse.ch/'
    }
  },
  methods: {
    filterUpdated (filteredValues) {
      this.filteredMalwareData = filteredValues
    },
    getMalwareData () {
      let url = 'http://localhost:8080/data/malware/feed'

      this.axios.get(url).then((response) => {
        this.malwareData = response.data
        this.filteredMalwareData = response.data
      })
    }
  },

  beforeMount () {
    this.getMalwareData()
  }
}
</script>

<style scoped>
  .content {
    padding: 10px;
  }
</style>
